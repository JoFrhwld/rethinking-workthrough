{
  "hash": "ac78ebe5d42160525cd135021b3b42a2",
  "result": {
    "markdown": "---\ntitle: \"Linear models, part 2\"\ndate: 2023-06-08\norder: 09\nformat: \n  html:\n   mermaid:\n     theme: neutral\n---\n\n\n::: callout-note\n## Listening\n\n<iframe style=\"border-radius:12px\" src=\"https://open.spotify.com/embed/track/2E1ZDtrJtsWdkyIbPDwFTu?utm_source=generator\" width=\"100%\" height=\"152\" frameBorder=\"0\" allowfullscreen allow=\"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture\" loading=\"lazy\">\n\n</iframe>\n:::\n\n## Loading\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggdist)\nlibrary(ggblend)\nlibrary(here)\n\nsource(here(\"_defaults.R\"))\n```\n:::\n\n\n## Finessing the model diagram\n\nI think I've improved on [the model diagram from the last post](../2023-06-05_07-linear-models-1/index.qmd). Some things I'm still struggling with:\n\n-   Formatting the node text. Can't seem to get either html nor markdown formatting to work.\n\n-   The background color on edge labels is absent, making the \"\\~\" illegible.\n\n\n```{mermaid}\n%%| echo: true\nflowchart TD\n  subgraph exp2[\"Exp\"]\n    one2[\"1\"]\n  end\n  exp2 -.-> sigma4\n  \n  subgraph normal4[\"normal\"]\n    mu4[\"μ=0\"]\n    sigma4[\"σ\"]\n  end\n  normal4 -.-> Gamma[γj]\n  Gamma --> gamma1\n  \n  subgraph normal3[\"normal\"]\n    mu3[\"μ=0\"]\n    sigma3[\"σ=10\"]\n  end\n  normal3 -.-> beta1\n  \n  subgraph normal2[\"normal\"]\n    mu2[\"μ=0\"]\n    sigma2[\"σ=10\"]\n  end\n  normal2 -.-> beta0\n  \n  subgraph sum1[\"+\"]\n    beta0[\"β₀\"]\n    subgraph mult1[\"×\"]\n      beta1[\"β₁\"]\n      x[\"xᵢ\"]\n    end\n    gamma1[\"γj[i]\"]\n  end\n  \n  sum1 --> mu1\n  \n  subgraph exp1[\"Exp\"]\n    one1[1]\n  end\n  exp1 -.->|\"~\"| sigma1\n  \n  subgraph normal1[\"normal\"]\n    mu1[\"μᵢ\"]\n    sigma1[\"σ\"]\n  end\n  \n  normal1 -.->|\"~\"| y[\"yᵢ\"]\n```\n\n\nHere's the global water model. I'll replace the $\\mathcal{U}(0,1)$ prior with the equivalent beta distribution, just for the consistency of going beta -\\> binomial/bernoulli. I'll also notate the beta distribution with [mean and precision](https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#mean-and-precision-instead-of-shapes).\n\n$$\n\\mathcal{U}(0,1) = \\text{Beta}(a=1, b=1) = \\text{Beta}(\\mu=0.5, \\phi=2)\n$$\n\nbecause\n\n$$\na = \\mu\\phi\n$$\n\n$$\nb = (1-\\mu)\\phi\n$$\n\n\n```{mermaid}\nflowchart TD\n\nsubgraph beta1[\"beta\"]\n  mu[\"μ=0.5\"]\n  phi[\"ϕ=2\"]\nend\nbeta1 -.-> p\n\nsubgraph binomial1[\"binomial\"]\n  N\n  p\nend\n\nbinomial1 -.-> W\n```\n\n\n## Height data\n\n`{cmdstanr}` is a dependency for `{rmcelreath/rethinking}`, and I don't want to deal with that right now, so I'm just going to read the data from github.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nread_delim(\n  \"https://raw.githubusercontent.com/rmcelreath/rethinking/master/data/Howell1.csv\", \n  delim = \";\"\n) ->\n  Howell1\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gt)\nlibrary(gtsummary)\n```\n:::\n\n\n`{gtsummary}` has a summary table function that's pretty ok. Not sure how to incorporate histograms into it like `rethinking::precis()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHowell1 |> \n  tbl_summary()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"dftuwleepr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#dftuwleepr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#dftuwleepr thead, #dftuwleepr tbody, #dftuwleepr tfoot, #dftuwleepr tr, #dftuwleepr td, #dftuwleepr th {\n  border-style: none;\n}\n\n#dftuwleepr p {\n  margin: 0;\n  padding: 0;\n}\n\n#dftuwleepr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#dftuwleepr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#dftuwleepr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#dftuwleepr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#dftuwleepr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dftuwleepr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dftuwleepr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dftuwleepr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#dftuwleepr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#dftuwleepr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#dftuwleepr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#dftuwleepr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#dftuwleepr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#dftuwleepr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#dftuwleepr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#dftuwleepr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#dftuwleepr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#dftuwleepr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#dftuwleepr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dftuwleepr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#dftuwleepr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#dftuwleepr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#dftuwleepr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dftuwleepr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#dftuwleepr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#dftuwleepr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dftuwleepr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dftuwleepr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#dftuwleepr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dftuwleepr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#dftuwleepr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dftuwleepr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dftuwleepr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dftuwleepr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dftuwleepr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dftuwleepr .gt_left {\n  text-align: left;\n}\n\n#dftuwleepr .gt_center {\n  text-align: center;\n}\n\n#dftuwleepr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#dftuwleepr .gt_font_normal {\n  font-weight: normal;\n}\n\n#dftuwleepr .gt_font_bold {\n  font-weight: bold;\n}\n\n#dftuwleepr .gt_font_italic {\n  font-style: italic;\n}\n\n#dftuwleepr .gt_super {\n  font-size: 65%;\n}\n\n#dftuwleepr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#dftuwleepr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#dftuwleepr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#dftuwleepr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#dftuwleepr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#dftuwleepr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#dftuwleepr .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;N = 544&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>N = 544</strong><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">height</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">149 (125, 157)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">weight</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">40 (22, 47)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">age</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">27 (12, 43)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">male</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">257 (47%)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"2\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> Median (IQR); n (%)</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n\n\nI'll get histograms with some pivoting and `ggdist::stat_slab(density=\"histogram\")`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHowell1 |> \n  mutate(row = row_number()) |> \n  pivot_longer(\n    -row,\n    names_to = \"variable\",\n    values_to = \"value\"\n    ) |> \n  ggplot(aes(value))+\n    stat_slab(\n      normalize = \"panels\", \n      density = \"histogram\"\n    )+\n    facet_wrap(\n      ~variable, \n      scales = \"free\"\n    )+\n    theme_no_y()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=576}\n:::\n:::\n\n\nHeight has a pretty long leftward tail because children are included in the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHowell1 |> \n  ggplot(aes(height, factor(male)))+\n    stat_slab()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=576}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nHowell1 |> \n  ggplot(aes(age, height, color = factor(male)))+\n    geom_point()+\n    stat_smooth(method = \"gam\", formula = y ~ s(x, bs = 'cs'))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=576}\n:::\n:::\n\n\n### Aside, experimenting with `{marginaleffects}`\n\nThe Rethinking book just cuts the age at 18, but the trend for men and women in the figure above looks like it's still increasing until at least 25. I'll mess around with `marginaleffects::slopes()` to see when the growth trend really stops.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mgcv)\nlibrary(marginaleffects)\n```\n:::\n\n\n`mgcv::gam()` doesn't like it when the `s(by=…)` argument isn't a factor, so preparing for modelling.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHowell1 |> \n  mutate(male = factor(male)) ->\n  height_to_mod\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod <- gam(height ~ male + s(age, by = male), data = height_to_mod)\n```\n:::\n\n\nI'd have to double check the documentation for how to specify which variable you want the slope across, but I know how to do it with a new dataframe, so I'll just do that and filter. I set `eps` to 1, which I think will estimate the number of centimeters per year.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nslopes(\n  mod,\n  eps = 1,\n  newdata = datagrid(\n    age = 0:80,\n    male = c(0,1)\n  )\n) |> \n  as_tibble() |> \n  filter(term == \"age\") ->\n  age_slopes\n\nage_slopes |> \n  ggplot(aes(age, estimate, color = male))+\n    geom_ribbon(\n      aes(\n        ymin = conf.low,\n        ymax = conf.high,\n        fill = male\n      ),\n      alpha = 0.5\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=576}\n:::\n:::\n\n\nAs a quick and dirty heuristic, I'll just check what the earliest age is that the high and low sides of the confidence interval have different signs.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nage_slopes |> \n  filter(sign(conf.low) != sign(conf.high))  |> \n  arrange(age) |> \n  group_by(male) |> \n  slice(1) |> \n  select(term, age, male, estimate, conf.low, conf.high)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 6\n# Groups:   male [2]\n  term    age male  estimate conf.low conf.high\n  <chr> <int> <fct>    <dbl>    <dbl>     <dbl>\n1 age      24 0        0.258  -0.0508     0.567\n2 age      28 1        0.176  -0.103      0.455\n```\n:::\n:::\n\n\nLooks like the age women probably stopped growing is \\~24 and for men \\~28. So I'll filter the data for age \\>= 30 just to be safe.\n\n## Height normality\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstable_height <- Howell1 |> \n  filter(age >= 30)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstable_height |> \n  ggplot(aes(height))+\n    stat_slab()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=576}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstable_height |> \n  ggplot(aes(height, factor(male)))+\n    stat_slab()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=576}\n:::\n:::\n\n\n## The Model\n\nRethinking gives the following model specification.\n\n$$\nh_i \\sim \\mathcal{N}(\\mu, \\sigma)\n$$\n\n$$\n\\mu \\sim \\mathcal{N}(178, 20)\n$$\n\n$$\n\\sigma \\sim \\mathcal{U}(0,50)\n$$\n\n\n```{mermaid}\nflowchart TD\n\nsubgraph uniform1[\"uniform\"]\n  a[\"a=0\"]\n  b[\"b=50\"]\nend\nuniform1 -.-> sigma1\n\nsubgraph normal2[\"normal\"]\n  mu2[\"μ=178\"]\n  sigma2[\"σ=20\"]\nend\nnormal2 -.-> mu1\n\nsubgraph normal1[\"normal\"]\n  mu1[\"μ\"]\n  sigma1[\"σ\"]\nend\n\nnormal1 -.-> h[\"hᵢ\"]\n```\n\n\nJust for some heuristics, I'll calculate the mean, standard error of the mean, and standard deviation of the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstable_height |> \n  summarise(\n     mean = mean(height),\n     sd = sd(height),\n     sem = sd/sqrt(n())\n  ) |> \n  gt() |> \n  fmt_number(decimals = 1)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"fiazwanhjs\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#fiazwanhjs table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#fiazwanhjs thead, #fiazwanhjs tbody, #fiazwanhjs tfoot, #fiazwanhjs tr, #fiazwanhjs td, #fiazwanhjs th {\n  border-style: none;\n}\n\n#fiazwanhjs p {\n  margin: 0;\n  padding: 0;\n}\n\n#fiazwanhjs .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#fiazwanhjs .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#fiazwanhjs .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#fiazwanhjs .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#fiazwanhjs .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fiazwanhjs .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fiazwanhjs .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fiazwanhjs .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#fiazwanhjs .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#fiazwanhjs .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#fiazwanhjs .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#fiazwanhjs .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#fiazwanhjs .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#fiazwanhjs .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#fiazwanhjs .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fiazwanhjs .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#fiazwanhjs .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#fiazwanhjs .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#fiazwanhjs .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fiazwanhjs .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#fiazwanhjs .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#fiazwanhjs .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#fiazwanhjs .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fiazwanhjs .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#fiazwanhjs .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#fiazwanhjs .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fiazwanhjs .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fiazwanhjs .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#fiazwanhjs .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fiazwanhjs .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#fiazwanhjs .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fiazwanhjs .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fiazwanhjs .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fiazwanhjs .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fiazwanhjs .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fiazwanhjs .gt_left {\n  text-align: left;\n}\n\n#fiazwanhjs .gt_center {\n  text-align: center;\n}\n\n#fiazwanhjs .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#fiazwanhjs .gt_font_normal {\n  font-weight: normal;\n}\n\n#fiazwanhjs .gt_font_bold {\n  font-weight: bold;\n}\n\n#fiazwanhjs .gt_font_italic {\n  font-style: italic;\n}\n\n#fiazwanhjs .gt_super {\n  font-size: 65%;\n}\n\n#fiazwanhjs .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#fiazwanhjs .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#fiazwanhjs .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#fiazwanhjs .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#fiazwanhjs .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#fiazwanhjs .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#fiazwanhjs .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mean\">mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sd\">sd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sem\">sem</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"mean\" class=\"gt_row gt_right\">154.6</td>\n<td headers=\"sd\" class=\"gt_row gt_right\">7.8</td>\n<td headers=\"sem\" class=\"gt_row gt_right\">0.5</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nSo, the $\\sigma$ for the hyperprior is *much* higher than the standard error, which is good, cause I guess we'd want our prior to be looser than the uncertainty we have about the sample mean.\n\nI think I'd like to look at our sample estimates and how they compare to the priors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbind_rows(\n  tibble(\n    x = seq(118, 238, length = 100),\n    dens = dnorm(\n      x,\n      mean = 178,\n      sd = 20\n    ),\n    param = \"mu\"\n  ),\n  tibble(\n    x = seq(0, 50, length = 100),\n    dens = dunif(x, 0, 50),\n    param = \"sigma\"\n  )\n)->\n  model_priors\n\nbind_rows(\n  tibble(\n    param = \"mu\",\n    x = 154.6,\n    dens = dnorm(\n      x,\n      mean = 178,\n      sd = 20\n    ),\n  ),\n  tibble(\n    param = \"sigma\",\n    x = 7.8,\n    dens = dunif(x, 0, 50)\n  )\n)->\n  sample_estimates\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_priors |> \n  ggplot(aes(x, dens))+\n    geom_area(fill = \"grey80\")+\n    geom_point(\n      data = sample_estimates,\n      size = 3\n    )+\n    geom_segment(\n      data = sample_estimates,\n      aes(\n        xend = x,\n        yend = 0\n      ),\n      linewidth = 1\n    )+\n    facet_wrap(\n      ~param, \n      scales = \"free_x\"\n      )+\n    theme_no_y()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-21-1.png){width=576}\n:::\n:::\n\n\nI'll try setting up the priors like they are in the book *without* looking at Solomon Kurz' translation, then double check I did it right.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(brms)\n```\n:::\n\n\nI know that you can set up a model formula with just `bf()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_formula <- bf(\n  height ~ 1\n)\n```\n:::\n\n\nAnd I know you can get a table of the default priors it plans to use with `get_prior()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_prior(height_formula, data = stable_height) |> \n  gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"brfmrtadrc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#brfmrtadrc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#brfmrtadrc thead, #brfmrtadrc tbody, #brfmrtadrc tfoot, #brfmrtadrc tr, #brfmrtadrc td, #brfmrtadrc th {\n  border-style: none;\n}\n\n#brfmrtadrc p {\n  margin: 0;\n  padding: 0;\n}\n\n#brfmrtadrc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#brfmrtadrc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#brfmrtadrc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#brfmrtadrc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#brfmrtadrc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#brfmrtadrc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#brfmrtadrc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#brfmrtadrc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#brfmrtadrc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#brfmrtadrc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#brfmrtadrc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#brfmrtadrc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#brfmrtadrc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#brfmrtadrc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#brfmrtadrc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#brfmrtadrc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#brfmrtadrc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#brfmrtadrc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#brfmrtadrc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#brfmrtadrc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#brfmrtadrc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#brfmrtadrc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#brfmrtadrc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#brfmrtadrc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#brfmrtadrc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#brfmrtadrc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#brfmrtadrc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#brfmrtadrc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#brfmrtadrc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#brfmrtadrc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#brfmrtadrc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#brfmrtadrc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#brfmrtadrc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#brfmrtadrc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#brfmrtadrc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#brfmrtadrc .gt_left {\n  text-align: left;\n}\n\n#brfmrtadrc .gt_center {\n  text-align: center;\n}\n\n#brfmrtadrc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#brfmrtadrc .gt_font_normal {\n  font-weight: normal;\n}\n\n#brfmrtadrc .gt_font_bold {\n  font-weight: bold;\n}\n\n#brfmrtadrc .gt_font_italic {\n  font-style: italic;\n}\n\n#brfmrtadrc .gt_super {\n  font-size: 65%;\n}\n\n#brfmrtadrc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#brfmrtadrc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#brfmrtadrc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#brfmrtadrc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#brfmrtadrc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#brfmrtadrc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#brfmrtadrc .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prior\">prior</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"class\">class</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"coef\">coef</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"group\">group</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"resp\">resp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"dpar\">dpar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"nlpar\">nlpar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"lb\">lb</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ub\">ub</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"source\">source</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\">student_t(3, 153.7, 9.4)</td>\n<td headers=\"class\" class=\"gt_row gt_left\">Intercept</td>\n<td headers=\"coef\" class=\"gt_row gt_right\"></td>\n<td headers=\"group\" class=\"gt_row gt_right\"></td>\n<td headers=\"resp\" class=\"gt_row gt_right\"></td>\n<td headers=\"dpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"nlpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"lb\" class=\"gt_row gt_right\"></td>\n<td headers=\"ub\" class=\"gt_row gt_right\"></td>\n<td headers=\"source\" class=\"gt_row gt_left\">default</td></tr>\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\">student_t(3, 0, 9.4)</td>\n<td headers=\"class\" class=\"gt_row gt_left\">sigma</td>\n<td headers=\"coef\" class=\"gt_row gt_right\"></td>\n<td headers=\"group\" class=\"gt_row gt_right\"></td>\n<td headers=\"resp\" class=\"gt_row gt_right\"></td>\n<td headers=\"dpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"nlpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"lb\" class=\"gt_row gt_right\">0</td>\n<td headers=\"ub\" class=\"gt_row gt_right\"></td>\n<td headers=\"source\" class=\"gt_row gt_left\">default</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n`{ggdist}` has a way of parsing and plotting these distributions pretty directly, but to get it how I want it to be requires getting a little hacky with ggplot2.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nget_prior(height_formula, data = stable_height) |> \n  parse_dist(prior) |> \n  ggplot(aes(dist = .dist, args = .args))+\n    stat_slab(aes(fill = after_stat(y>0)))+\n    facet_wrap(~class, scales = \"free_x\")+\n    scale_fill_manual(\n      values = c(\"#ffffff00\", ptol_blue),\n      guide = \"none\")+\n    coord_flip()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-25-1.png){width=576}\n:::\n:::\n\n\nAnyway, to set up the priors like it is in the book, we need to do this. (Note from future Joe: I'd gotten this close, but had messed up how non-standard evaluation works and had to check Solomon Kurz' book. e.g, there's no function called `normal()`).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nc(\n  prior(\n    prior = normal(178, 20),\n    class = Intercept\n  ),\n  prior(\n    prior = uniform(0,50),\n    lb = 0,\n    ub = 50,\n    class = sigma\n  )\n) -> example_priors\n\nexample_priors |> \n  gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"kgaydfbbyr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#kgaydfbbyr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#kgaydfbbyr thead, #kgaydfbbyr tbody, #kgaydfbbyr tfoot, #kgaydfbbyr tr, #kgaydfbbyr td, #kgaydfbbyr th {\n  border-style: none;\n}\n\n#kgaydfbbyr p {\n  margin: 0;\n  padding: 0;\n}\n\n#kgaydfbbyr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#kgaydfbbyr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#kgaydfbbyr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#kgaydfbbyr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#kgaydfbbyr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kgaydfbbyr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kgaydfbbyr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kgaydfbbyr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#kgaydfbbyr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#kgaydfbbyr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#kgaydfbbyr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#kgaydfbbyr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#kgaydfbbyr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#kgaydfbbyr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#kgaydfbbyr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kgaydfbbyr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#kgaydfbbyr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#kgaydfbbyr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#kgaydfbbyr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kgaydfbbyr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#kgaydfbbyr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#kgaydfbbyr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#kgaydfbbyr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kgaydfbbyr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#kgaydfbbyr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#kgaydfbbyr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kgaydfbbyr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kgaydfbbyr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#kgaydfbbyr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kgaydfbbyr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#kgaydfbbyr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kgaydfbbyr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kgaydfbbyr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kgaydfbbyr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kgaydfbbyr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kgaydfbbyr .gt_left {\n  text-align: left;\n}\n\n#kgaydfbbyr .gt_center {\n  text-align: center;\n}\n\n#kgaydfbbyr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#kgaydfbbyr .gt_font_normal {\n  font-weight: normal;\n}\n\n#kgaydfbbyr .gt_font_bold {\n  font-weight: bold;\n}\n\n#kgaydfbbyr .gt_font_italic {\n  font-style: italic;\n}\n\n#kgaydfbbyr .gt_super {\n  font-size: 65%;\n}\n\n#kgaydfbbyr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#kgaydfbbyr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#kgaydfbbyr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#kgaydfbbyr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#kgaydfbbyr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#kgaydfbbyr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#kgaydfbbyr .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prior\">prior</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"class\">class</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"coef\">coef</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"group\">group</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"resp\">resp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"dpar\">dpar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"nlpar\">nlpar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"lb\">lb</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ub\">ub</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"source\">source</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\">normal(178, 20)</td>\n<td headers=\"class\" class=\"gt_row gt_left\">Intercept</td>\n<td headers=\"coef\" class=\"gt_row gt_right\"></td>\n<td headers=\"group\" class=\"gt_row gt_right\"></td>\n<td headers=\"resp\" class=\"gt_row gt_right\"></td>\n<td headers=\"dpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"nlpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"lb\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"ub\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"source\" class=\"gt_row gt_left\">user</td></tr>\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\">uniform(0, 50)</td>\n<td headers=\"class\" class=\"gt_row gt_left\">sigma</td>\n<td headers=\"coef\" class=\"gt_row gt_right\"></td>\n<td headers=\"group\" class=\"gt_row gt_right\"></td>\n<td headers=\"resp\" class=\"gt_row gt_right\"></td>\n<td headers=\"dpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"nlpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"lb\" class=\"gt_row gt_right\">0</td>\n<td headers=\"ub\" class=\"gt_row gt_right\">50</td>\n<td headers=\"source\" class=\"gt_row gt_left\">user</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbrm(\n  height_formula,\n  prior = example_priors,\n  family = gaussian,\n  data = stable_height,\n  sample_prior = T,\n  file = \"height_mod.rds\"\n) ->\n  height_mod\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_mod\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n Family: gaussian \n  Links: mu = identity; sigma = identity \nFormula: height ~ 1 \n   Data: stable_height (Number of observations: 251) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nPopulation-Level Effects: \n          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nIntercept   154.60      0.50   153.64   155.60 1.00     3070     2230\n\nFamily Specific Parameters: \n      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma     7.88      0.36     7.20     8.63 1.00     3523     2251\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n```\n:::\n:::\n\n\nWell! Estimated parameters here are basically right on top of the maximum likelihood estimates from the sample, including the standard error of the Intercept.\n\nHaving read over [the marginaleffects book](https://vincentarelbundock.github.io/marginaleffects/), I know I can get posterior draws of the predictions with `predictions() |> posterior_draws()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredictions(\n  height_mod,\n  newdata = datagrid()\n) |> \n  posterior_draws() |> \n  ggplot(aes(draw))+\n    stat_slabinterval()+\n    theme_no_y()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-29-1.png){width=576}\n:::\n:::\n\n\nSince this was an intercept-only model, this is basically a distribution of the estimate for the intercept, rather than predicted *observed* values. So I can actually compare this to the prior.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredictions(\n  height_mod,\n  newdata = datagrid()\n) |> \n  posterior_draws() |> \n  ggplot(aes(draw))+\n    stat_slabinterval()+\n    geom_line(\n      data = model_priors |> \n        filter(param == \"mu\"),\n      aes(\n        x = x,\n        y = dens/max(dens),\n        )\n    )+\n    theme_no_y()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-30-1.png){width=576}\n:::\n:::\n\n\nTo compare the predicted observed values from the model to the actual data, we can use `brms::pp_check()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npp_check(height_mod)+\n  khroma::scale_color_bright()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-31-1.png){width=576}\n:::\n:::\n\n\n### General look at parameters\n\nTo get the posterior samples of the parameters, I think we need to turn to tidybayes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidybayes)\n```\n:::\n\n\nTo get the parameter names that we want to get samples from, `tidybayes::get_variables()` on the model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_variables(height_mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"b_Intercept\"     \"sigma\"           \"prior_Intercept\" \"prior_sigma\"    \n [5] \"lprior\"          \"lp__\"            \"accept_stat__\"   \"stepsize__\"     \n [9] \"treedepth__\"     \"n_leapfrog__\"    \"divergent__\"     \"energy__\"       \n```\n:::\n:::\n\n\nThe non standard evaluation here still kind of freaks me out. I'll use `spread_draws()` which will put the posterior draw for each parameter in its own column.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_mod |> \n  spread_draws(\n   b_Intercept,\n   sigma\n  ) ->\n  height_param_wide\n\nhead(height_param_wide)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n  .chain .iteration .draw b_Intercept sigma\n   <int>      <int> <int>       <dbl> <dbl>\n1      1          1     1        155.  8.18\n2      1          2     2        155.  7.51\n3      1          3     3        155.  7.91\n4      1          4     4        155.  7.77\n5      1          5     5        154.  7.77\n6      1          6     6        154.  7.77\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_param_wide |> \n  ggplot(aes(b_Intercept, sigma))+\n    geom_point()+\n    theme(aspect.ratio = 1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-35-1.png){width=576}\n:::\n:::\n\n\nTo get the parameters long-wise, we need to use `gather_draws()`. I'm assuming the function names for `{tidybayes}` were settled in back when the pivoting functions in `{tidyr}` were still `gather()` and `spread()`.[^1]\n\n[^1]: I still have a soft spot for `reshape2::melt()` and `reshape2::cast()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_mod |> \n  gather_draws(\n   b_Intercept,\n   sigma\n  ) ->\n  height_param_long\n\nhead(height_param_long)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n# Groups:   .variable [1]\n  .chain .iteration .draw .variable   .value\n   <int>      <int> <int> <chr>        <dbl>\n1      1          1     1 b_Intercept   155.\n2      1          2     2 b_Intercept   155.\n3      1          3     3 b_Intercept   155.\n4      1          4     4 b_Intercept   155.\n5      1          5     5 b_Intercept   154.\n6      1          6     6 b_Intercept   154.\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_param_long |> \n  ggplot(\n    aes(.value,)\n  )+\n    stat_slab()+\n    theme_no_y()+\n    facet_wrap(\n      ~.variable,\n      scales = \"free_x\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-37-1.png){width=576}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggdensity)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_param_wide |>  \n  ggplot(aes(b_Intercept, sigma))+\n    stat_hdr(fill = ptol_blue)+\n    theme(aspect.ratio = 1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-39-1.png){width=576}\n:::\n:::\n\n\n## The linear model\n\nThe next thing the book moves onto is modelling height with weight.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstable_height |> \n  ggplot(aes(weight, height))+\n    geom_point()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-40-1.png){width=576}\n:::\n:::\n\n\nWe're going to standardize the weight measure. That way, the intercept & prior for the intercept will be defined at the mean weight.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstable_height |> \n  mutate(\n    weight0 = weight-mean(weight)\n  )->\n  height_to_mod\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_weight_formula <- bf(\n  height ~ 1 + weight0\n)\n```\n:::\n\n\nGet the default priors\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_prior(\n  height_weight_formula,\n  data = height_to_mod\n) |> \n  gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"pbucdvqebp\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#pbucdvqebp table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#pbucdvqebp thead, #pbucdvqebp tbody, #pbucdvqebp tfoot, #pbucdvqebp tr, #pbucdvqebp td, #pbucdvqebp th {\n  border-style: none;\n}\n\n#pbucdvqebp p {\n  margin: 0;\n  padding: 0;\n}\n\n#pbucdvqebp .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#pbucdvqebp .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#pbucdvqebp .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#pbucdvqebp .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#pbucdvqebp .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pbucdvqebp .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pbucdvqebp .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pbucdvqebp .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#pbucdvqebp .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#pbucdvqebp .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#pbucdvqebp .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#pbucdvqebp .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#pbucdvqebp .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#pbucdvqebp .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#pbucdvqebp .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#pbucdvqebp .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#pbucdvqebp .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#pbucdvqebp .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#pbucdvqebp .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbucdvqebp .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#pbucdvqebp .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#pbucdvqebp .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#pbucdvqebp .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbucdvqebp .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#pbucdvqebp .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#pbucdvqebp .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pbucdvqebp .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbucdvqebp .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#pbucdvqebp .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pbucdvqebp .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#pbucdvqebp .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pbucdvqebp .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pbucdvqebp .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbucdvqebp .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pbucdvqebp .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbucdvqebp .gt_left {\n  text-align: left;\n}\n\n#pbucdvqebp .gt_center {\n  text-align: center;\n}\n\n#pbucdvqebp .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#pbucdvqebp .gt_font_normal {\n  font-weight: normal;\n}\n\n#pbucdvqebp .gt_font_bold {\n  font-weight: bold;\n}\n\n#pbucdvqebp .gt_font_italic {\n  font-style: italic;\n}\n\n#pbucdvqebp .gt_super {\n  font-size: 65%;\n}\n\n#pbucdvqebp .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#pbucdvqebp .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#pbucdvqebp .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#pbucdvqebp .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#pbucdvqebp .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#pbucdvqebp .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#pbucdvqebp .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prior\">prior</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"class\">class</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"coef\">coef</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"group\">group</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"resp\">resp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"dpar\">dpar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"nlpar\">nlpar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"lb\">lb</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ub\">ub</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"source\">source</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\"></td>\n<td headers=\"class\" class=\"gt_row gt_left\">b</td>\n<td headers=\"coef\" class=\"gt_row gt_left\"></td>\n<td headers=\"group\" class=\"gt_row gt_right\"></td>\n<td headers=\"resp\" class=\"gt_row gt_right\"></td>\n<td headers=\"dpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"nlpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"lb\" class=\"gt_row gt_right\"></td>\n<td headers=\"ub\" class=\"gt_row gt_right\"></td>\n<td headers=\"source\" class=\"gt_row gt_left\">default</td></tr>\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\"></td>\n<td headers=\"class\" class=\"gt_row gt_left\">b</td>\n<td headers=\"coef\" class=\"gt_row gt_left\">weight0</td>\n<td headers=\"group\" class=\"gt_row gt_right\"></td>\n<td headers=\"resp\" class=\"gt_row gt_right\"></td>\n<td headers=\"dpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"nlpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"lb\" class=\"gt_row gt_right\"></td>\n<td headers=\"ub\" class=\"gt_row gt_right\"></td>\n<td headers=\"source\" class=\"gt_row gt_left\">default</td></tr>\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\">student_t(3, 153.7, 9.4)</td>\n<td headers=\"class\" class=\"gt_row gt_left\">Intercept</td>\n<td headers=\"coef\" class=\"gt_row gt_left\"></td>\n<td headers=\"group\" class=\"gt_row gt_right\"></td>\n<td headers=\"resp\" class=\"gt_row gt_right\"></td>\n<td headers=\"dpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"nlpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"lb\" class=\"gt_row gt_right\"></td>\n<td headers=\"ub\" class=\"gt_row gt_right\"></td>\n<td headers=\"source\" class=\"gt_row gt_left\">default</td></tr>\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\">student_t(3, 0, 9.4)</td>\n<td headers=\"class\" class=\"gt_row gt_left\">sigma</td>\n<td headers=\"coef\" class=\"gt_row gt_left\"></td>\n<td headers=\"group\" class=\"gt_row gt_right\"></td>\n<td headers=\"resp\" class=\"gt_row gt_right\"></td>\n<td headers=\"dpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"nlpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"lb\" class=\"gt_row gt_right\">0</td>\n<td headers=\"ub\" class=\"gt_row gt_right\"></td>\n<td headers=\"source\" class=\"gt_row gt_left\">default</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nDefine our custom priors, based on the first model in the book.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_weight_priors <- c(\n  prior(\n    prior = normal(178, 20),\n    class = Intercept\n  ),\n  prior(\n    prior = uniform(0,50),\n    lb = 0,\n    ub = 50,\n    class = sigma\n  ),\n  prior(\n    prior = normal(0,10),\n    class = b\n  )\n)\n\nheight_weight_priors |> \n  gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"avhberglea\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#avhberglea table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#avhberglea thead, #avhberglea tbody, #avhberglea tfoot, #avhberglea tr, #avhberglea td, #avhberglea th {\n  border-style: none;\n}\n\n#avhberglea p {\n  margin: 0;\n  padding: 0;\n}\n\n#avhberglea .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#avhberglea .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#avhberglea .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#avhberglea .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#avhberglea .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#avhberglea .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#avhberglea .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#avhberglea .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#avhberglea .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#avhberglea .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#avhberglea .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#avhberglea .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#avhberglea .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#avhberglea .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#avhberglea .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#avhberglea .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#avhberglea .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#avhberglea .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#avhberglea .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#avhberglea .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#avhberglea .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#avhberglea .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#avhberglea .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#avhberglea .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#avhberglea .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#avhberglea .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#avhberglea .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#avhberglea .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#avhberglea .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#avhberglea .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#avhberglea .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#avhberglea .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#avhberglea .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#avhberglea .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#avhberglea .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#avhberglea .gt_left {\n  text-align: left;\n}\n\n#avhberglea .gt_center {\n  text-align: center;\n}\n\n#avhberglea .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#avhberglea .gt_font_normal {\n  font-weight: normal;\n}\n\n#avhberglea .gt_font_bold {\n  font-weight: bold;\n}\n\n#avhberglea .gt_font_italic {\n  font-style: italic;\n}\n\n#avhberglea .gt_super {\n  font-size: 65%;\n}\n\n#avhberglea .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#avhberglea .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#avhberglea .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#avhberglea .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#avhberglea .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#avhberglea .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#avhberglea .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prior\">prior</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"class\">class</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"coef\">coef</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"group\">group</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"resp\">resp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"dpar\">dpar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"nlpar\">nlpar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"lb\">lb</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ub\">ub</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"source\">source</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\">normal(178, 20)</td>\n<td headers=\"class\" class=\"gt_row gt_left\">Intercept</td>\n<td headers=\"coef\" class=\"gt_row gt_right\"></td>\n<td headers=\"group\" class=\"gt_row gt_right\"></td>\n<td headers=\"resp\" class=\"gt_row gt_right\"></td>\n<td headers=\"dpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"nlpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"lb\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"ub\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"source\" class=\"gt_row gt_left\">user</td></tr>\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\">uniform(0, 50)</td>\n<td headers=\"class\" class=\"gt_row gt_left\">sigma</td>\n<td headers=\"coef\" class=\"gt_row gt_right\"></td>\n<td headers=\"group\" class=\"gt_row gt_right\"></td>\n<td headers=\"resp\" class=\"gt_row gt_right\"></td>\n<td headers=\"dpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"nlpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"lb\" class=\"gt_row gt_right\">0</td>\n<td headers=\"ub\" class=\"gt_row gt_right\">50</td>\n<td headers=\"source\" class=\"gt_row gt_left\">user</td></tr>\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\">normal(0, 10)</td>\n<td headers=\"class\" class=\"gt_row gt_left\">b</td>\n<td headers=\"coef\" class=\"gt_row gt_right\"></td>\n<td headers=\"group\" class=\"gt_row gt_right\"></td>\n<td headers=\"resp\" class=\"gt_row gt_right\"></td>\n<td headers=\"dpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"nlpar\" class=\"gt_row gt_right\"></td>\n<td headers=\"lb\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"ub\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"source\" class=\"gt_row gt_left\">user</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nheight_weight_priors |> \n  parse_dist(prior) |> \n  ggplot(aes(dist = .dist, args = .args))+\n    stat_slab()+\n    facet_wrap(~class, scales = \"free_x\")+\n    coord_flip()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-45-1.png){width=576}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbrm(\n  height_weight_formula,\n  prior = height_weight_priors,\n  data = height_to_mod, \n  file = \"height_weight_mod.rds\",\n  file_refit = \"on_change\"\n) ->\n  height_weight_mod\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_weight_mod\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n Family: gaussian \n  Links: mu = identity; sigma = identity \nFormula: height ~ 1 + weight0 \n   Data: height_to_mod (Number of observations: 251) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nPopulation-Level Effects: \n          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nIntercept   154.58      0.33   153.93   155.23 1.00     3643     2923\nweight0       0.91      0.05     0.81     1.01 1.00     3978     2773\n\nFamily Specific Parameters: \n      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma     5.16      0.23     4.73     5.66 1.00     3752     2830\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n```\n:::\n:::\n\n\nHere's the usual kind of \"fit + credible interval\" plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_weight_mod |> \n  predictions(\n    newdata = datagrid(\n      weight0 = seq(-13, 18, length = 100)\n    )\n  ) |> \n  posterior_draws() |> \n  mutate(\n    weight = weight0 + mean(height_to_mod$weight)\n  ) |> \n  ggplot(\n    aes(weight, draw)\n  )+\n    stat_lineribbon()+\n    labs(\n      y = \"height\"\n    )+\n    scale_fill_brewer(palette = \"Blues\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-48-1.png){width=576}\n:::\n:::\n\n\nHere's the \"all of the predicted fitted lines\" plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_weight_mod |> \n  predictions(\n    newdata = datagrid(\n      weight0 = seq(-13, 18, length = 100)\n    )\n  ) |> \n  posterior_draws() |> \n  mutate(\n    weight = weight0 + mean(height_to_mod$weight)\n  ) |> \n  filter(\n    as.numeric(drawid) <= 100\n  ) |> \n  ggplot(\n    aes(weight, draw)\n  )+\n    geom_line(\n      aes(group = drawid),\n      alpha = 0.1\n    )+\n    labs(\n      y = \"height\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-49-1.png){width=576}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npp_check(height_weight_mod)+\n  khroma::scale_color_bright()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-50-1.png){width=576}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_weight_mod |> \n  get_variables()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"b_Intercept\"   \"b_weight0\"     \"sigma\"         \"lprior\"       \n [5] \"lp__\"          \"accept_stat__\" \"stepsize__\"    \"treedepth__\"  \n [9] \"n_leapfrog__\"  \"divergent__\"   \"energy__\"     \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_weight_mod |> \n  spread_draws(\n    `b_.*`,\n    sigma,\n    regex = T\n  ) |> \n  ggplot(aes(b_Intercept, b_weight0))+\n    stat_hdr()+\n    theme(aspect.ratio = 1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-52-1.png){width=576}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}